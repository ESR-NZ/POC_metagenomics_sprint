---
title: "POC metagenomics dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

```{r global, include = FALSE}
# Load libraries
library(flexdashboard)
library(here)

# Setup path to directory of recentrifuge html files
shiny::addResourcePath(prefix = "www", directoryPath = here::here("www"))

# Create a list of samples based on the files present in the kraken output directory
isolates <- list.files(path = "www")

# Get only the sample names from the file list (everything before "_")
isolates <- sub("_.*", "", isolates)

# Get the unique samples names
isolates <- unique(isolates)
```

Inputs {.sidebar}
-----------------------------------------------------------------------

```{r}
# User input to choose sample of interest to view ----
selectizeInput("isolate",
               h4("Select or search for an isolate:"),
               choices = isolates,
               options = list(maxItems = 1))
```
    
Column {data-width=600}
-------------------------------------
    
### recentrifuge
    
```{r}
# Embed the appropriate recentrifuge html file in the dashboard

# Load in the current isolate the user has chosen to view so it can be used for "recentrifuge_html_path"
selected_isolate <- reactive(input$isolate)
recentrifuge_html_path <- reactive(paste0(context_path, selected_isolate(), "_kr2_output.krk.rcf.html"))

# Plot
renderUI({
  
  # Print a message if no isolate is chosen
  validate(need(input$isolate, "Please choose an isolate from the drop down box to create a plot"))
  
  # Embed html
  tags$iframe(src=recentrifuge_html_path(), height="100%", width="100%")
  
})
```
   
Column {data-width = 400}
-------------------------------------
   
### Chart 2

```{r}

```   
 
### Chart 3
    
```{r}

```

